---
layout: post
title:  "Docker安装与基本操作"
date:   2017-11-01 10:15:20
categories: Docker
permalink: /archivers/Docker安装与基本操作
---

## 核心概念

**Docker镜像**类似于虚拟机镜像，可以理解为一个面向Docker引擎的只读模板，包含了文件系统。镜像是创建Docker容器的基础。

**Docker容器**类似于一个轻量级的沙箱，Docker利用容器来运行和隔离应用。容器是从镜像创建的应用运行实例，可以将其启动、停止、删除，而这些容器都是相互隔离、互不可见的。
镜像自身是只读的。容器从镜像启动的时候，Docker会在镜像的最上层创建一个可写层，镜像本身将保持不变。

**Docker仓库**类似于代码仓库，是Docker集中存放镜像文件的场所。Docker仓库分为公开仓库和私有仓库。

**注册服务器（Registry）**是存放仓库的地方，其上往往存放着多个仓库。每个仓库集中存放某一类镜像，往往包括多个镜像文件，通过不同的标签（tag）来进行区分。

## Docker安装

### Ubuntu

Ubuntu 14.04 版本官方软件源中已经自带了Docker包，较低版本需要先进行内核更新并重启系统：

```shell
$ sudo apt-get update
$ sudo apt-get install -y linux-image-generic-lts-raring linux-headers-generic-lts-raring
$ sudo reboot
```

安装Docker

```shell
$ sudo apt-get update
$ sudo apt-get install -y docker.io
$ sudo ln -sf /usr/bin/docker.io /usr/bin/docker
$ sudo sed -i '$acomplete -F _docker docker' /etc/bash_completion.d/docker.io
```

系统默认的Docker安装包相对较旧，可通过以下方式从Docker官方源安装最新版本。

```shell
$ sudo apt-get install apt-transport-https
$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 36A1D7869245C8950F966E92D8576A8BA88D21E9
$ sudo bash -c "echo deb https://get.docker.io/ubuntu docker main > /etc/apt/sources.list.d/docker.list"
$ sudo apt-get update
$ sudo apt-get -y lxc-docker
```

### CentOS

#### CentOS 6

```shell
$ sudo yum install -y http://mirrors.yun-idc.com/epel/6/i386/epel-release-6-8.noarch.rpm
$ sudo yum install -y docker-io
```

#### CentOS 7

```shell
$ sudo yum install -y docker
```

更新方式：自行通过源码编译安装；下载二进制文件更新。

### Windows

Docker通过虚拟机方式支持Windows 7和8，前提是主机的CPU支持硬件虚拟化。

* 从[https://docs.docker.com/installation/windows/](https://docs.docker.com/installation/windows/)下载最新官方Docker for Windows Installer。

* 运行Installer，该过程将安装VirtualBox，MSYS-git，boot2docker Linux ISO镜像，以及Boot2Docker管理工具。

* 打开桌面的Boot2Docker Start程序，或者用以下命令：`Program Files > Boot2Docker for Windows`。此初始化脚本在第一次运行时需要输入一个SSH Key Passphrase（用于SSH密钥生成的口令），也可直接跳过。

* 此时Boot2Docker Start程序将连接至虚拟机中的Shell会话，Docker已经运行起来了。

### Mac OS

Docker支持Mac OS 10.6 Snow Leopard及以上版本的Mac OS，同样需要Boot2Docker工具的支持。

* 从[https://docs.docker.com/installation/mac/](https://docs.docker.com/installation/mac/)下载最新官方Docker for OS X Installer。

* 运行安装包，该过程将安装一个VirtualBox虚拟机，Docker本身以及Boot2Docker管理工具。

* 安装成功，找到Boot2Docker并运行它，现在进行Boot2Docker的初始化：

```shell
$ boot2docker init
$ boot2docker start
$ $(boot2docker shellinit)
```

* 看到虚拟机在命令行窗口中启动运行，并显示Docker的启动信息，则说明Docker安装成功。当虚拟机初始化完毕后，可以使用`boot2docker stop`和`boot2docker start`来控制它。

* 注意：如果在命令行中看到如下提示信息：

```
To connect the Docker client to the Docker daemon, please set: export DOCKER_HOST=tcp://192.168.59.103:2375
```

可以执行提示信息中的语句：`export DOCKER_HOST=tcp://192.168.59.103:2375`在系统环境变量中设置Docker的主机地址。

## docker基本操作

### 镜像

#### 获取镜像

命令`docker pull NAME[:TAG]`获取镜像。如不显式的指定TAG，则默认选择latest标签。

```shell
[root@localhost test]# docker pull ubuntu:14.04
14.04: Pulling from library/ubuntu
bae382666908: Pull complete 
29ede3c02ff2: Pull complete 
da4e69f33106: Pull complete 
8d43e5f5d27f: Pull complete 
b0de1abb17d6: Pull complete 
Digest: sha256:6e3e3f3c5c36a91ba17ea002f63e5607ed6a8c8e5fbbddb31ad3e15638b51ebc
Status: Downloaded newer image for ubuntu:14.04
```

#### 查看镜像信息

命令`docker images`列出本地主机上已有的镜像。

[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              latest              747cb2d60bbe        2 weeks ago         122MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB


命令`docker inspect IMAGE_ID` 可以获取该镜像的详细信息。

```shell
[root@localhost test]# docker inspect dea1945146b9
[
    {
        "Id": "sha256:dea1945146b96542e6e20642830c78df702d524a113605a906397db1db022703",
        "RepoTags": [
            "ubuntu:14.04"
        ],
        "RepoDigests": [
            "ubuntu@sha256:6e3e3f3c5c36a91ba17ea002f63e5607ed6a8c8e5fbbddb31ad3e15638b51ebc"
        ],
        "Parent": "",
        "Comment": "",
        "Created": "2017-09-13T23:26:23.127186526Z",
        "Container": "53c2a8c09f3e5b092cb05b323a382b2935476bc84353b102922c5c14b2bd3305",
        "ContainerConfig": {
            "Hostname": "53c2a8c09f3e",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/sh",
                "-c",
                "#(nop) ",
                "CMD [\"/bin/bash\"]"
            ],
            "ArgsEscaped": true,
            "Image": "sha256:2013c3d8a4f2376ef9d2922271c8bc6a913cb3109a34966dbaefe5057a9da766",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {}
        },
        "DockerVersion": "17.06.2-ce",
        "Author": "",
        "Config": {
            "Hostname": "",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/bash"
            ],
            "ArgsEscaped": true,
            "Image": "sha256:2013c3d8a4f2376ef9d2922271c8bc6a913cb3109a34966dbaefe5057a9da766",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": null
        },
        "Architecture": "amd64",
        "Os": "linux",
        "Size": 187971405,
        "VirtualSize": 187971405,
        "GraphDriver": {
            "Data": {
                "RootDir": "/var/lib/docker/overlay/9da37272f7684597b528479a3f91389673cd37351fd5ce8f51668d3df02af8b1/root"
            },
            "Name": "overlay"
        },
        "RootFS": {
            "Type": "layers",
            "Layers": [
                "sha256:c47d9b229ca4eaf5d3b85b6fa7f794d00910a42634dd0fd5107a9a937b13b20f",
                "sha256:bf59e7acf5c4eefb6b27e7973a8afa6214f7a6da99c20a94195665ab52d442b2",
                "sha256:48daf661d621ef19b6df743b9fcfcb50044ba34d0b8b5161f4061dba49902e9b",
                "sha256:4e1e6ac5b9d6cde7dabfdaa6a0e8f5a8986c4f8bb63689085fdfaca0ccae698d",
                "sha256:7fb9ba64f896b3a7001af9604a44243cfa663c84e414cd298ee8bc754feb5aa1"
            ]
        }
    }
]
```

`docker tag REPOSITORY:TAG`可为本地镜像添加新的标签。

```shell
[root@localhost test]# docker tag ubuntu:latest latest_ubuntu:latest
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              latest              747cb2d60bbe        2 weeks ago         122MB
latest_ubuntu       latest              747cb2d60bbe        2 weeks ago         122MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
```

#### 搜索镜像

`docker search`命令搜索远端仓库中的共享镜像。

```
参数：
--automated=false 仅显示自动创建的镜像
--no-trunc=false 输出信息不截断显示
-s，--starts=0 指定仅显示评价为指定星级以上的镜像
```

```shell
[root@localhost test]# docker search mysql
NAME                                                   DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                                                  MySQL is a widely used, open-source relati...   5160      [OK]       
mariadb                                                MariaDB is a community-developed fork of M...   1598      [OK]       
mysql/mysql-server                                     Optimized MySQL Server Docker images. Crea...   360                  [OK]
percona                                                Percona Server is a fork of the MySQL rela...   298       [OK]       
hypriot/rpi-mysql                                      RPi-compatible Docker Image with Mysql          72                   
zabbix/zabbix-server-mysql                             Zabbix Server with MySQL database support       62                   [OK]
centurylink/mysql                                      Image containing mysql. Optimized to be li...   53                   [OK]
sameersbn/mysql                                                                                        48                   [OK]
zabbix/zabbix-web-nginx-mysql                          Zabbix frontend based on Nginx web-server ...   36                   [OK]
tutum/mysql                                            Base docker image to run a MySQL database ...   27                   
schickling/mysql-backup-s3                             Backup MySQL to S3 (supports periodic back...   16                   [OK]
1and1internet/ubuntu-16-nginx-php-phpmyadmin-mysql-5   ubuntu-16-nginx-php-phpmyadmin-mysql-5          16                   [OK]
centos/mysql-57-centos7                                MySQL 5.7 SQL database server                   13                   
linuxserver/mysql                                      A Mysql container, brought to you by Linux...   12                   
openshift/mysql-55-centos7                             DEPRECATED: A Centos7 based MySQL v5.5 ima...   6                    
centos/mysql-56-centos7                                MySQL 5.6 SQL database server                   6                    
frodenas/mysql                                         A Docker Image for MySQL                        3                    [OK]
dsteinkopf/backup-all-mysql                            backup all DBs in a mysql server                3                    [OK]
circleci/mysql                                         MySQL is a widely used, open-source relati...   2                    
cloudfoundry/cf-mysql-ci                               Image used in CI of cf-mysql-release            0                    
astronomerio/mysql-sink                                MySQL sink                                      0                    [OK]
cloudposse/mysql                                       Improved `mysql` service with support for ...   0                    [OK]
ansibleplaybookbundle/rhscl-mysql-apb                  An APB which deploys RHSCL MySQL                0                    [OK]
astronomerio/mysql-source                              MySQL source                                    0                    [OK]
jenkler/mysql                                          Docker Mysql package                            0                    
```

#### 删除镜像

命令`docker rmi IMAGE[IMAGE...]`IMAGE可以为标签或ID

使用镜像ID来删除时，会先尝试删除所有指向该镜像的标签，然后删除该镜像文件本身。

> 注意：当有该镜像创建的容器存在时，镜像文件默认是无法被删除的。

`docker ps -a`命令可以看到本机上存在的所有容器。

强制删除镜像用`docker rmi -f IMAGE`命令。使用`-f`参数来强制删除一个存在容器依赖的镜像会造成一些遗留问题。正确做法是先删除依赖镜像的所有容器，再来删除镜像。删除容器用`docker rm CONTAINER_ID`命令。

```shell
[root@localhost test]# docker ps -a
CONTAINER ID      IMAGE             COMMAND          CREATED           STATUS                            PORTS        NAMES
a40fcdb8f675      ubuntu:latest     "/bin/bash"      5 minutes ago     Exited (127) About a minute ago                agitated_lalande
[root@localhost test]# docker rm a40fcdb8f675
a40fcdb8f675
[root@localhost test]# docker rmi 747cb2d60bbe
Untagged: ubuntu:latest
Untagged: ubuntu@sha256:506e2d5852de1d7c90d538c5332bd3cc33b9cbd26f6ca653875899c505c82687
Deleted: sha256:747cb2d60bbecbda48aff14a8be5c8b913ca69318a6067e57c697f8a78dda06e
Deleted: sha256:ec1fd849ff0a8f0aa2fd1acc29ad5dabbc79b89f63b74a4f54e31a7b0a100aa1
Deleted: sha256:e3f6dffa20cf36460d23bfb22e17be6e5339891f8537f32db79887caf832048b
Deleted: sha256:c213ffdc9f7032702de5a8e9045fcce2353b7221ef6bf4509e02005cfc858f58
Deleted: sha256:3fddf55a451aa43707518f2d8788c12ee5eb1f1e3075433f5bcf4d445d5c275d
Deleted: sha256:0f5ff0cf6a1c53f94b15f03536c490040f233bc455f1232f54cc8eb344a3a368
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
```

#### 创建镜像

基于已有镜像的容器创建使用命令`docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]`命令。

```
参数：
-a，--author="" 作者信息
-m，--message"" 提交信息
-p，--pause=true 提交时暂停容器运行
```

```shell
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
[root@localhost test]# docker run -ti ubuntu:14.04 /bin/bash
root@098ab9bc25f8:/# touch test
root@098ab9bc25f8:/# exit
exit
[root@localhost test]# docker commit -m "Added a new file" -a "Docker Test" 098ab9bc25f8 test
sha256:68ceff3107a82641378dee544caeed48e6d544b4d74b525051381b7db7479d35
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
test                latest              68ceff3107a8        16 seconds ago      188MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
```

基于本地模板导入使用`cat 镜像压缩包 | docker import -REPOSITORY:TAG`命令。

```shell
[root@localhost test]# ls
ubuntu-14.04-x86_64-minimal.tar.gz
[root@localhost test]# cat ubuntu-14.04-x86_64-minimal.tar.gz | docker import - ubuntu:14.04-server
sha256:ae63a9e87332075323de0e2cb3e12dd6ea8c6078e006dd937dc0d670c4a8773d
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04-server        ae63a9e87332        12 seconds ago      215MB
test                latest              68ceff3107a8        About an hour ago   188MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
```

#### 存出镜像

命令`docker save -o 压缩包保存名 REPOSITORY:TAG`可存出镜像。

```shell
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04-server        ae63a9e87332        12 seconds ago      215MB
test                latest              68ceff3107a8        About an hour ago   188MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
[root@localhost test]# docker save -o ubuntu_server.tar ubuntu:14.04
[root@localhost test]# ls
ubuntu_server.tar
```

#### 载入镜像

命令`docker load --input 压缩包保存名`或者`docker load < 压缩包保存名`可从导出的文件中重新载入镜像。

```shell
[root@localhost test]# ls
ubuntu_server.tar
[root@localhost test]# docker load --input ubuntu_server.tar 
Loaded image: ubuntu:14.04
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04-server        ae63a9e87332        4 minutes ago       215MB
test                latest              68ceff3107a8        About an hour ago   188MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
``` 

#### 上传镜像

可以使用`docker push NAME[:TAG]`上传镜像到仓库，默认上传到DockerHub官方仓库。第一次使用必须要先登录。

```shell
[root@localhost test]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04-server        ae63a9e87332        4 minutes ago       215MB
test                latest              68ceff3107a8        About an hour ago   188MB
ubuntu              14.04               dea1945146b9        6 weeks ago         188MB
[root@localhost test]# docker tag test:latest username/test:latest
[root@localhost test]# docker images
REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE
ubuntu                14.04-server        ae63a9e87332        7 minutes ago       215MB
username/test         latest              68ceff3107a8        About an hour ago   188MB
test                  latest              68ceff3107a8        About an hour ago   188MB
ubuntu                14.04               dea1945146b9        6 weeks ago         188MB
[root@localhost test]# docker login
Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username: username
Password: 
Login Succeeded
[root@localhost test]# docker push username/test:latest
The push refers to a repository [docker.io/username/test]
786a798121af: Pushed 
7fb9ba64f896: Pushed 
4e1e6ac5b9d6: Pushed 
48daf661d621: Pushed 
bf59e7acf5c4: Pushed 
c47d9b229ca4: Pushed 
latest: digest: sha256:c46955d49b5b7cf15528b94d5c4fb7028b61c52cf00ee4d14073a92379e2237f size: 1566
```

### 容器

#### 创建容器

可以使用`docker create`命令来新建一个容器，新建的容器处于停止状态，可以使用`docker start CONTAINER_ID`命令来启动它。

```shell
[root@localhost test]# docker create -it ubuntu:14.04
1fea7f4a60ec1f33298b69dbbe736c6a3509a3a39756d93c20914f451e857356
[root@localhost test]# docker ps -a
CONTAINER ID     IMAGE            COMMAND          CREATED           STATUS         PORTS   NAMES
1fea7f4a60ec     ubuntu:14.04     "/bin/bash"      17 seconds ago    Created                eager_blackwell
[root@localhost test]# docker start 1fea7f4a60ec
1fea7f4a60ec
[root@localhost test]# docker ps -a
CONTAINER ID     IMAGE            COMMAND          CREATED           STATUS         PORTS   NAMES
1fea7f4a60ec     ubuntu:14.04     "/bin/bash"      2 minutes ago     Up 16 seconds          eager_blackwell
```

#### 启动容器

启动容器有两种方式：基于镜像新建一个容器并启动；将在终止状态的容器重新启动。

所需的命令主要为`docker run`，等价于先执行`docker create`，再执行`docker start`。

启动一个bash终端，允许用户进行交互，`-t`参数让Docker分配一个伪终端并绑定到容器的标准输入上，`-i`参数则让容器的标准输入保持打开，`-d`参数会让Docker容器在后台以守护形式运行，获取容器输出信息，可通过`docker logs`命令。

```shell
[root@localhost test]# docker run -t -i ubuntu:14.04 /bin/bash
root@eac23878c8bf:/# pwd
/
root@eac23878c8bf:/# ls
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
root@eac23878c8bf:/# ps
   PID TTY          TIME CMD
     1 pts/0    00:00:00 bash
    15 pts/0    00:00:00 ps
root@eac23878c8bf:/# exit
exit
[root@localhost test]# docker run -d ubuntu:14.04 /bin/sh -c "while true; do echo hello word; sleep 1; done"
2105fbb444b3b028a1b26ec5879d8d282ccc2fa7d0a9776a8a86e808d3414843
[root@localhost test]# docker ps -a
CONTAINER ID     IMAGE            COMMAND                  CREATED           STATUS             PORTS     NAMES
2105fbb444b3     ubuntu:14.04     "/bin/sh -c 'while..."   11 seconds ago    Up 10 seconds                confident_payne
eac23878c8bf     ubuntu:14.04     "/bin/bash"              2 minutes ago     Exited (0) 2 minutes ago     adoring_shockley
[root@localhost test]# docker logs 2105fbb444b3
hello word
hello word
hello word
hello word
...
[root@localhost test]# docker stop 2105
```

#### 终止容器

可以用`docker stop [-t|--time [=10]]`来终止一个运行中的容器。

`docker ps -a -q`查看处于终止状态的容器的ID信息，`docker start`启动一个处于终止状态的容器，`docker restart`将一个运行态的容器终止然后再重新启动它。

```shell
[root@localhost test]# docker stop 2105
2105
[root@localhost test]# docker ps -a -q
2105fbb444b3
eac23878c8bf
[root@localhost test]# docker start 2105
2105
[root@localhost test]# docker ps 
CONTAINER ID     IMAGE            COMMAND                  CREATED           STATUS           PORTS      NAMES
2105fbb444b3     ubuntu:14.04     "/bin/sh -c 'while..."   2 minutes ago     Up 9 seconds                confident_payne
[root@localhost test]# docker restart 2105
2105
[root@localhost test]# docker ps
CONTAINER ID     IMAGE            COMMAND                  CREATED           STATUS           PORTS      NAMES
2105fbb444b3     ubuntu:14.04     "/bin/sh -c 'while..."   3 minutes ago     Up 11 seconds               confident_payne
```

#### 进入容器

使用`-d`参数时容器会进入后台，用户无法看到容器中的信息。进入容器主要有以下三种方式。

`docker attach`当多个窗口同时attach到同一个容器时，所有窗口都会同步显示。当某个窗口因命令阻塞时，其他窗口也无法执行操作。
`docker exec`官方推荐使用。
nsenter工具，比较繁琐，不做过多概述。

```shell
[root@localhost test]# docker run -tid ubuntu:14.04
0b59f3ef98d47454a314b02d598e8f425855266feb58141178b541fcbdcfc76d
[root@localhost test]# docker ps
CONTAINER ID     IMAGE            COMMAND        CREATED          STATUS          PORTS     NAMES
0b59f3ef98d4     ubuntu:14.04     "/bin/bash"    8 seconds ago    Up 8 seconds              elegant_ride
[root@localhost test]# docker attach elegant_ride
root@0b59f3ef98d4:/# ls
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
root@0b59f3ef98d4:/# exit
exit
[root@localhost test]# docker run -tid ubuntu:14.04
a0bb97c292d1fe5d5e507a865c1925251c972dcee30fa65193c06e7ad2aabf0d
[root@localhost test]# docker ps
CONTAINER ID     IMAGE             COMMAND        CREATED          STATUS         PORTS     NAMES
a0bb97c292d1     ubuntu:14.04      "/bin/bash"    6 seconds ago    Up 6 seconds             brave_austin
[root@localhost test]# docker exec -ti a0bb97c292d1 /bin/bash
root@a0bb97c292d1:/# ls
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
root@a0bb97c292d1:/# exit
exit
```

#### 删除容器

可以使用`docker rm [OPTIONS] CONTAINER [CONTAINER...]`命令删除处于终止状态的容器。

```
参数：
-f，--force=false 强行终止并删除一个运行中的容器
-l，--link=false 删除容器的连接，但保留容器
-v，--volumes=false 删除容器挂载的数据卷
```

```shell
[root@localhost test]# docker ps -a
CONTAINER ID     IMAGE            COMMAND         CREATED           STATUS                    PORTS      NAMES
a0bb97c292d1     ubuntu:14.04     "/bin/bash"     8 minutes ago     Up 8 minutes                         brave_austin
0b59f3ef98d4     ubuntu:14.04     "/bin/bash"     14 minutes ago    Exited (0) 8 minutes ago             elegant_ride
[root@localhost test]# docker rm 0b59f3ef98d4
0b59f3ef98d4
[root@localhost test]# docker rm -f a0bb97c292d1
a0bb97c292d1
[root@localhost test]# docker ps -a
CONTAINER ID     IMAGE            COMMAND         CREATED           STATUS              PORTS            NAMES
```

#### 导入导出容器

导出容器是指导出一个已经创建好的容器到一个文件，不管此时这个容器是否处于运行状态，可以使用`docker export CONTAINER`命令。

```shell
[root@localhost test]# docker run -tid ubuntu:14.04
547e74d47ec3eb30736aee22c1b7bf2acd6e71470a1ade4561007a10b3b14a36
[root@localhost test]# docker ps -a
CONTAINER ID     IMAGE            COMMAND          CREATED          STATUS           PORTS       NAMES
547e74d47ec3     ubuntu:14.04     "/bin/bash"      6 seconds ago    Up 5 seconds                 unruffled_jennings
[root@localhost test]# docker export 547 > test.tar
[root@localhost test]# ls
test.tar 
```

导出的文件又可以使用`docker import`命令导入，成为镜像。

```shell
[root@localhost test]# ls
test.tar
[root@localhost test]# cat test.tar | docker import - test/ubuntu:v1.0
sha256:1ab7c63a882a9bc13ff4673081a237ba8785d47ba69458bfe976c0e5fc7b9c99
[root@localhost test]# docker images
REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE
test/ubuntu           v1.0                1ab7c63a882a        22 seconds ago      175MB
ubuntu                14.04-server        ae63a9e87332        2 hours ago         215MB
securityweekly/test   latest              68ceff3107a8        3 hours ago         188MB
ubuntu                14.04               dea1945146b9        6 weeks ago         188MB
```

### 仓库

登录
docker login命令输入用户名、密码、邮箱来完成注册和登录，认证信息保存在本地用户目录的.dockercfg中。

### 数据管理


### 网络基础配置


### Dockerfile



























